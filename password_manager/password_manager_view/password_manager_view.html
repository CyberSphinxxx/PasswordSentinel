<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Passwords - PasswordSentinel</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/password_manager/password_manager_view/password_manager_view_styles.css">
    <link href="https://fonts.googleapis.com/css2?family=PT+Serif:wght@400;700&display=swap" rel="stylesheet">
    <style>

    </style>
</head>
<body>
    <header>
        <div class="header-container">
            <div class="header-logo">
                <a href="/dashboard/dashboard.html">PasswordSentinel</a>
            </div>
            <nav class="header-nav">
                <ul class="header-nav-menu">
                    <li class="header-nav-item">
                        <a href="/password_generator/passwordgen.html" class="header-nav-link">Password Generator</a>
                    </li>
                    <li class="header-nav-item">
                        <a href="/password_manager/password_manager_save/password_manager_save.html" class="header-nav-link">Save Password</a>
                    </li>
                    <li class="header-nav-item">
                        <a href="/password_manager/password_manager_view/password_manager_view.html" class="header-nav-link">View Passwords</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="main-content">
        <div class="password-list-container">
            <h1>Saved Passwords</h1>
            <ul class="password-list" id="passwordList"></ul>
        </div>
    </div>

    <script>
        // Function to load saved passwords from local storage
        function loadPasswords() {
            const passwordList = document.getElementById('passwordList');
            const savedPasswords = JSON.parse(localStorage.getItem('savedPasswords') || '[]');
            passwordList.innerHTML = '';

            savedPasswords.forEach((encryptedData) => {
                try {
                    const decryptedData = atob(encryptedData); // Base64 decoding
                    const passwordObject = JSON.parse(decryptedData);

                    const passwordListItem = document.createElement('li');
                    passwordListItem.className = 'password-list-item';

                    const infoDiv = document.createElement('div');
                    infoDiv.innerHTML = `
                        <strong>Label:</strong> ${passwordObject.label}<br>
                        <strong>Username:</strong> ${passwordObject.username}
                    `;

                    const showPasswordButton = document.createElement('button');
                    showPasswordButton.textContent = 'Show Password';
                    
                    let passwordShown = false;
                    showPasswordButton.addEventListener('click', () => {
                        if (!passwordShown) {
                            const passwordText = document.createElement('div');
                            passwordText.innerHTML = `<br><strong>Password:</strong> ${passwordObject.password}`;
                            infoDiv.appendChild(passwordText);
                            showPasswordButton.textContent = 'Hide Password';
                            passwordShown = true;
                        } else {
                            infoDiv.removeChild(infoDiv.lastChild);
                            showPasswordButton.textContent = 'Show Password';
                            passwordShown = false;
                        }
                    });

                    passwordListItem.appendChild(infoDiv);
                    passwordListItem.appendChild(showPasswordButton);
                    passwordList.appendChild(passwordListItem);
                } catch (error) {
                    console.error('Error decoding password:', error);
                }
            });
        }

        // Load saved passwords on page load
        loadPasswords();
    </script>
</body>
</html>